$errorReprot={reportedArr:[],reportNum:0,report:function(i){try{if(limitTag=i.limitTag||!1,srcType=i.srcType||"",srcHref=i.srcHref||"",errorEvent=i.errorEvent||"",errorCode=i.errorCode||"",!limitTag&&$errorReprot.reportNum>=1)return void console.log("超过错误上报次数限制");$errorReprot.reportNum+=1;var a=location.href,e=navigator.userAgent,o="";e.indexOf("iPhone")!==-1||e.indexOf("iphone")!==-1?o="iPhone":e.indexOf("Android")===-1&&e.indexOf("android")===-1||(o="Android");var t="";if("iPhone"===o){var n=/iPhone OS (.*?) /g;t=n.exec(e),t&&t.length>1&&(t=t[1])}else if("Android"===o){var n=/Android (.*?);/g;t=n.exec(e),t&&t.length>1&&(t=t[1])}var u="";if("iPhone"===o)u=o;else if("Android"===o){var r=/; (.*?)\) AppleWebKit/g;if(u=r.exec(e),u&&u.length>1){u=u[1];var d=u.indexOf(";");d!==-1&&(u=u.substring(d+2))}}var y=/MicroMessenger\/(.*?) /g,l=y.exec(e);l=l&&l.length>1?l[1]:"";var s=/NetType\/(.*?) /g,c=s.exec(e);c=c&&c.length>1?c[1]:navigator.connection&&navigator.connection.type?navigator.connection.type:"";var $={src_type:srcType,src_href:srcHref,error_event:errorEvent,error_code:errorCode,page_href:a,user_agent:e,phone_type:u,system_type:o,system_ver:t,wx_ver:l,network_type:c},p=srcType+srcHref+errorEvent+errorCode;if($errorReprot.reportedArr.indexOf(p)>-1)return void console.log("上报过该类型错误了");$errorReprot.reportedArr.push(p),NetWork.request("error_report",$,function(i){}),console.log("error_report")}catch(g){console.log(g)}}},$audioContinue={readedArr:[],readTime:function(i,a){try{if(localStorage&&$audioContinue.readedArr.indexOf(i)==-1){var e=localStorage.getItem("audioTime");if(e){e=JSON.parse(e);var o=e[i];o&&a.currentTime<3&&(o-=3,o>0?a.currentTime=o:a.currentTime=.01,$audioContinue.readedArr.push(i),console.log($audioContinue.readedArr))}}}catch(t){console.log(t)}},saveTime:function(i,a){try{if(localStorage){var e=localStorage.getItem("audioTime");e=e?JSON.parse(e):{};var o=a.currentTime,t=a.duration;e[i]!==o&&o>3&&(t-o<=3?e[i]=0:e[i]=o,e=JSON.stringify(e),localStorage.setItem("audioTime",e))}}catch(n){console.log(n)}}},$liveVideoContinue={readArr:[],readTime:function(i,a){try{if(localStorage&&$liveVideoContinue.readArr.indexOf(i)==-1){var e=localStorage.getItem("liveVideoTime");if(e){e=JSON.parse(e);var o=e[i];o&&a.currentTime<3&&(o-=3,o>0?a.currentTime=o:a.currentTime=.01,$liveVideoContinue.readArr.push(i),console.log($liveVideoContinue.readArr))}}}catch(t){console.log(t)}},saveTime:function(i,a){try{if(localStorage){var e=localStorage.getItem("liveVideoTime");e=e?JSON.parse(e):{};var o=a.currentTime,t=a.duration;e[i]!==o&&o>3&&(t-o<=3?e[i]=0:e[i]=o,e=JSON.stringify(e),localStorage.setItem("liveVideoTime",e))}}catch(n){console.log(n)}}},$audioListPlay={$playingAudio:null,$playingAudioIndex:0,$playingAudioId:null,$playingAudioM3u8:null,$audioType:null,$playNum:[],init:function(){$audioListPlay.clickPlayButton(),$audioListPlay.updatePlayInfo(),$audioListPlay.playNextAuto()},clickPlayButton:function(){$(".content-list").on("click",".audioPlayButton",function(){var i=$(this);if(i){var a=$audioListPlay.getAudioSrc(i);i.hasClass("audioStopStatus")?$audioListPlay.playAudio(i,a):i.hasClass("audioPlayStatus")&&$audioListPlay.pauseAudio(i,a)}})},updatePlayInfo:function(){setInterval(function(){if($audioListPlay.$playingAudio&&!$audioListPlay.$playingAudio[0].paused){var i=$audioListPlay.$playingAudio[0].currentTime,a=$audioListPlay.$playingAudio[0].duration,e=parseInt(i/a*100);!isNaN(e)&&e>0&&e<=100?$(".audioPlayPercent").eq($audioListPlay.$playingAudioIndex).html(e):!isNaN(e)&&e>=100&&$(".audioPlayPercent").eq($audioListPlay.$playingAudioIndex).html(100);var o=$audioListPlay.$playingAudioId;$audioContinue.saveTime(o,$audioListPlay.$playingAudio[0]),a-i<=30&&($audioListPlay.$audioType?$audioActionAnalyse.$type=1:$audioActionAnalyse.$type=0,$audioActionAnalyse.$audioId=o,$audioActionAnalyse.finishCount()),i>1e-4&&$audioContinue.readTime(o,$audioListPlay.$playingAudio[0])}},500)},getAudioSrc:function(i){var a=i.children("audio").eq(0),e=i.data("m3u8"),o=i.data("mp3compress"),t=n=i.data("mp3");if(!a.attr("src")){var n="";o?n=o:e?n=e:t&&(n=t),a.attr("src",n)}return a},playAudio:function(i,a){$audioListPlay.$playingAudio&&$audioListPlay.$playingAudio[0].pause(),a[0].play();try{wx.getNetworkType({success:function(i){a[0].play()}})}catch(e){}if(console.log("play"),$audioListPlay.$playingAudioIndex=$(".audioDom").index(a),$audioListPlay.$playingAudio=a,$audioListPlay.$playingAudioId=$(".audioPlayButton").eq($audioListPlay.$playingAudioIndex).data("id"),$audioListPlay.$playingAudioM3u8=$(".audioPlayButton").eq($audioListPlay.$playingAudioIndex).data("m3u8"),$audioListPlay.$audioType=$(".audioPlayButton").eq($audioListPlay.$playingAudioIndex).data("try"),$audioListPlay.$playingAudio.on("canplay",function(){$audioContinue.readTime($audioListPlay.$playingAudioId,$audioListPlay.$playingAudio[0]),$audioListPlay.$playingAudio.off("canplay")}),$(".audioPlayPercentWrapper").eq($audioListPlay.$playingAudioIndex).show(),$(".audioPlayButton").removeClass("audioPlayStatus").addClass("audioStopStatus"),$(".audioTitle").removeClass("c7").addClass("c2"),$(".audioTitle").eq($audioListPlay.$playingAudioIndex).removeClass("c2").addClass("c7"),i.removeClass("audioStopStatus").addClass("audioPlayStatus"),$audioListPlay.$playNum.indexOf($audioListPlay.$playingAudioIndex)===-1){$audioListPlay.$playNum.push($audioListPlay.$playingAudioIndex),NetWork.request("addAudioViewCount/"+i.data("id"),{},function(i){}),$audioListPlay.$audioType?$audioActionAnalyse.$type=1:$audioActionAnalyse.$type=0,$audioActionAnalyse.$audioId=$audioListPlay.$playingAudioId,$audioActionAnalyse.playCount();var o=$(".audioViewCount").eq($audioListPlay.$playingAudioIndex).html();o&&o.indexOf("W")===-1&&(o=parseInt(o)+1,$(".audioViewCount").eq($audioListPlay.$playingAudioIndex).html(o))}},pauseAudio:function(i,a){a[0].pause(),i.removeClass("audioPlayStatus").addClass("audioStopStatus"),$(".audioTitle").removeClass("c7").addClass("c2")},playByIndex:function(i){var a=$(".audioPlayButton"),e=null,o=null;i<a.length?(e=a.eq(i),o=$audioListPlay.getAudioSrc(e),$audioListPlay.playAudio(e,o)):i-1<a.length&&(e=a.eq(i-1),o=$audioListPlay.getAudioSrc(e),$audioListPlay.pauseAudio(e,o))},playNextAuto:function(){$(".audioDom").each(function(){$(this).off("ended").on("ended",function(){$audioActionAnalyse.$type=0,$audioActionAnalyse.$audioId=$(".audioPlayButton").eq($audioListPlay.$playingAudioIndex).data("id"),$(".audioPlayPercent").eq($audioListPlay.$playingAudioIndex).html(100);var i=$audioListPlay.$playingAudioIndex+1;$audioListPlay.playByIndex(i)})})}},$audioActionAnalyse={$type:"",$audioId:"",$reported:[],playCount:function(){$audioActionAnalyse.reportToServer("play_count")},finishCount:function(){$audioActionAnalyse.reportToServer("finish_count")},reportToServer:function(i){var a={type:$audioActionAnalyse.$type,audio_id:$audioActionAnalyse.$audioId,action:i},e=JSON.stringify(a);$audioActionAnalyse.$reported.indexOf(e)===-1&&($audioActionAnalyse.$reported.push(e),NetWork.request("audio_action_analyse",a,function(i){}),console.log(i))}},$giftBuy={minLimit:1,maxLimit:100,buyCount:parseInt($("#selector_show").val()),buying:!1,piece_price:parseFloat($("#payPrice").val()),init:function(){$(".giftBuyButton").each(function(){$(this).on("click",function(){$(".payManyPart").show();var i=$("#appId").val(),a=$("#coupons_gift").val();"undefined"!=typeof Storage?localStorage[i+"_first_gift"]?($("#prePayManyWrapper").hide(),a.length<5?$("#payManyWrapper").show():$(".couponPaymentBoxGift").show()):($("#payManyWrapper").hide(),$("#prePayManyWrapper").show()):$("#prePayManyWrapper").show(),_czc.push(["_trackEvent","btn_send","btn_click","赠送按钮"])})}),$("#preGiftBuyButton").click(function(){var i=$("#appId").val();$("#prePayManyWrapper").hide();var a=$("#coupons_gift").val();a.length<5?$("#payManyWrapper").show():$(".couponPaymentBoxGift").show(),localStorage[i+"_first_gift"]=!0}),$("#payManyPart").off("click").on("click",function(){$(".payManyPart").hide(),$(".couponPaymentBoxGift").hide(),$("body").off("touchmove")}),$("#payManyPart #prePayManyWrapper, #payManyPart #payManyWrapper").click(function(i){i&&i.stopPropagation?i.stopPropagation():window.event.cancelBubble=!0}),$giftBuy.buyCardAction()},buyCardAction:function(){$("#reduce_count").click(function(i){i.stopPropagation(),$giftBuy.buyCount=$giftBuy.buyCount-1,$giftBuy.buyCount<$giftBuy.minLimit&&($giftBuy.buyCount=$giftBuy.minLimit),$giftBuy.updatePrice()}),$("#add_count").click(function(i){i.stopPropagation(),$giftBuy.buyCount=$giftBuy.buyCount+1,$giftBuy.buyCount>$giftBuy.maxLimit&&($giftBuy.buyCount=$giftBuy.maxLimit),$giftBuy.updatePrice()}),$("#selector_show").change(function(){var i=parseInt($(this).val());isNaN(i)?$giftBuy.updatePrice():($giftBuy.buyCount=i,$giftBuy.buyCount<$giftBuy.minLimit?$giftBuy.buyCount=$giftBuy.minLimit:$giftBuy.buyCount>$giftBuy.maxLimit&&($giftBuy.buyCount=$giftBuy.maxLimit),$giftBuy.updatePrice())}),$("#giftBuyButton").click(function(){if(_czc.push(["_trackEvent","btn_sendpay","btn_click","赠送支付"]),!$giftBuy.buying){$giftBuy.buying=!0;var i={count:$giftBuy.buyCount,buy_gift:1};NetWork.request("pay/get_info",i,function(i){var a=$.parseJSON(i);if(0==a.code){var e=a.data.payConfig;if(e&&e["package"]){var o=e["package"].split("=")[1];if("undefined"==typeof WeixinJSBridge)return void($giftBuy.buying=!1);WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,"package":e["package"],signType:e.signType,paySign:e.paySign},function(i){if(i.err_code){var a={type:"user_pay_err_per_minute",extra:"js"};if(NetWork.request("log_watcher_data",a,function(i){}),$giftBuy.buying=!1,3==i.err_code||2==i.err_code){var e=window.location.hostname.indexOf(".h5.");e===-1?$giftBuy.scanUrl="/"+window.APPID+"/pay/scan_image/"+o:$giftBuy.scanUrl="/pay/scan_image/"+o,$(".scan_window_image").attr("src",$giftBuy.scanUrl),$(".scan_layer").css("display","block"),$(".navigation_menu").css("display","none")}else alert(i.err_code+" "+i.err_msg)}else if("get_brand_wcpay_request:ok"==i.err_msg){var t=new Date;eJump("/gift_list?"+t.getTime(),!0)}else"get_brand_wcpay_request:cancel"==i.err_msg?$giftBuy.buying=!1:$giftBuy.buying=!1})}}})}})},updatePrice:function(){$("#selector_show").val($giftBuy.buyCount);var i=$giftBuy.buyCount*$giftBuy.piece_price;i=parseInt(i).toLocaleString()+i.toFixed(2).toString().slice(-3),$("#total_price").html("¥"+i)}},$(function(){document.body.addEventListener("touchstart",function(){})});